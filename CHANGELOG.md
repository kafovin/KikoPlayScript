# 更新日志

`KikoPlay`脚本 `TMDb` 的更新日志。

+ [更新日志](#更新日志)
  + [v 0](#v-0)
    + [0.1](#01)
      + [0.1.Beta1](#01beta1)
    + [0.0](#00)

## v 0

### 0.1

0.1.2.220302_build

+ tvmazelist.lua

  + feature：新特性

    + 显示英美剧的日历时间表。日历分组按星期划分。

    + 可以设置 时间表的排序方式：按每日时间档、按日期时间、按标题。

  + minor feature：微调

    + 右键剧集一行，可以打开主页、IMDb页面、TVmaze页面 (如果有)。

    + 可以设置 时区。

    + 目前标签可以跨某一周识别，因为当前标签是跟随标题的。

0.1.2.220227_build

+ tmdb.lua

  + fix：修复bug。

    + 修复了演员表中，演员自己扮演自己的情况。

    + 修复了没有职员表刮削到的时候，`显示元数据`无法弹出对话框的情况。

    + 修复了部分情况下演职员表、语言、地区、出品方、剧集播映平台等 重复、无法显示的情况。

+ tvmazelist.lua
  
  + docs：

    + 新建文件夹  (\*￣▽￣\*)

0.1.2.220226_alpha

+ feature：新特性

  + 搜索功能，现在脚本默认设置先将输入作为无拓展名的文件名识别，用识别的媒体标题和季序号搜索电影或某季剧集。

  + 海报背景等图片，可以在设置中选择从fanart获取，需要在[fanart.tv](https://fanart.tv/get-an-api-key/)申请`Personal API`(个人API密钥)填入脚本设置。

  + 部分无法匹配媒体及其单集信息的情况下，会使用随机的集序号以完成匹配。

+ minor feature：微调

  + 在资料库媒体海报 右键`显示媒体元数据`，可以查看更多媒体元数据。
  
    + 可以设置 此处显示的图片种类。tmdb仅支持海报、背景，fanart支持较多种类。
  
  + 在资料库媒体海报右键，增加了 `打开媒体主页`、`打开IMDb页面`。

0.1.2.220224_build

+ feature：新特性

  + 演职员表可在资料库中媒体的`角色`一页看到。

  + 语言地区、发行状态、出品方、剧集的放映平台几项，已加入标签，可以在资料库中媒体的`标签`一页、或资料库侧边栏的索引看到。

+ minor feature：微调

  + 刮削时，更多地获取、保留了一些媒体元数据。

+ refactor：代码重构

  + 将部分已有的函数包装到几个`table`类型的全局变量中，以方便调用。

0.1.2.220223_build

+ feature：新特性
  
  + 增加了自动关联本地媒体文件的功能。
  
    设置TMDb脚本为默认关联脚本后，拖拽未加入且未关联过的媒体文件到播放列表时，会自动依据文件名关联媒体信息。

    + 由于TMDb的集数是整数，所以关联和刮削时会忽略文件名中形如`12.5`、`E02-03`的集数。请在关联之后，手动更改错误的媒体信息，比如此情况容易导致该集之后所有集数的集序号错误。

    + 其中，未找到媒体信息或单集信息的媒体、未识别到集数的媒体特别篇等，不会关联成功。

+ minor feature：微调

  + 当搜索、关联、获取详细信息时，如果使用的API密钥不正确，会在浏览器弹出 申请API密钥 所在的网址。

+ refactor：代码重构

  + 分离了函数search(keyword)的基本功能，即 TMDb搜索标题关键词获取媒体列表，以方便其他函数调用。
  
  + 更改脚本存储的图片链接为除去域名信息的特征部分，不再是完全的网址，以方便显示不同大小的图片。
  
+ build：依赖更新

  + KikoPlay 于2022-02-23 更新了测试版(0.8.2 +)。

    KikoPlay 修复了设置默认关联脚本无效的bug。

  + KikoPlay 于2022-02-21 更新了测试版(0.8.2 +)。

    KikoPlay 脚本API 提供了新功能，实现了用正则表达式 搜索、匹配、替换字符串。

0.1.2.220220_build

+ minor feature：微调

  + 改变了部分设置项

    + 增加了设置项`匹配 - 备用媒体类型`，设置模糊匹配不确定媒体类型时所用的备用类型（指电影或剧集）。

    + 为`元数据 - 语言`增加了选项，提供多种语言代码。

    <!-- + ~~把设置项`match_type`改为`match_source`即`匹配 - 来源类型`，以便安装过旧版本的用户直接使用新的默认设置； （没有必要恶更改，在build前已取消）~~ -->
    + 在设置项`匹配 - 来源类型`添加了`online_TMDb_filename`选项，作为当前的默认值。匹配时从文件名模糊识别关键词、再用TMDb的API刮削关键词 (未实现)。
  
  + 对部分标签增加了父标签，以简化侧边栏中`标签`的视图。(220217_build)

    + 与以往不兼容。"搜索详细信息"后，新格式的标签会出现；以往的标签仍会保留，直至在资料库侧边栏的`标签`部分手动删除。
  
  + 在资料库条目右键菜单，增加了`显示媒体元数据`，用以显示刮削到的元数据。(220217_build)

+ style：格式更新

  + 因为用的格式化插件好像换了或者设置不一样了，有许多空白字符变了，希望以后不会这样了……

  + 眼见代码量上涨，却并未真的实现多样化的功能，对于重构精简代码继续无动于衷，于是大量不必要的注释仍然保留 (￣▽￣)。
  
+ refactor：代码重构

  + 更改了部分设置项的描述；
  
+ build：依赖更新

  + KikoPlay 于2022-02-12 更新至版本 0.8.2。

---

0.1.1.220109_build

+ docs：文档更新

  + 更新了 README.md；

    增加了如何获取详细信息的部分；
    添加了fork到的两个分支有何不同；
    详细了致谢的内容。
  
    改变了目录结构。(220106_build)
  
  + 添加了 CAHNGELOG.md；
  
    用于记录脚本`TMDb`的更新日志。
  
  + 在 github 从 `/KikoPlayProject/KikoPlayScript` fork 了分支。(220106_build)

    从 fork 得到的 master 创建了两个分支：

    + library-tmdb-pr：用于向 `/KikoPlayProject/KikoPlayScript` 提交RC版本的脚本`TMDb`。
    + library-tmdb-beta：用于提供脚本`TMDB` 的测试版，以及该脚本的安装、使用方法。

+ style：格式更新

  + 添加了大量注释，避免以后看不懂（目前约占代码的一半）。(220106_build)

#### 0.1.Beta1

 **0.1.Beta1**  /  0.1.1.211230_beta

+ fix：修复bug。

  + 处理、获取、转换字符或数字字段时，不再会得到nil或空字符串。（重新发现解决方法，因为忘记了之前怎么debug的，以及~~假装~~存档部分丢失 ~~其实是没备份~~）
  
  + 获取详细信息时，KikoPlay不会再一边显示“正在从 TMDb 获取信息… ”、一边卡住。

    解决方法：这是一个已解决bug，更新KikoPlay至测试版。

+ minor feature：微调

  + 继续实现 获取详细信息 (detail) 的功能。

    依赖搜索时获取的 数据字段(`data`)。获取媒体的剧情介绍、海报图片、首映/首播日期、分集数、媒体的TMDb页面链接。

    \* *还未实现 演员表、职员表等。*

  + 继续实现 获取标签 (gettags) 的功能。

    依赖搜索时获取的 数据字段(`data`)。包含流派类型，~~部分包含语言地区、出品方~~等。

  + 修改了 `元数据使用原语言标题` 的默认值，从`1`(使用) 改为了 `0`(不使用)。

+ docs：文档更新

  + 添加了 README.md。

    包含使用方法等。

+ build：依赖更新

  + KikoPlay版本更新，更新至 0.8.2-beta。

0.1.0.211229_alpha

+ feature：新特性

  + 实现了 搜索媒体信息 (search) 的功能。

    依赖TMDb的API，从TMDb请求，通过搜索用户输入的关键字，获取媒体信息列表。媒体的多种信息存储在 数据字段(`data`)。

  + 实现了 获取分集信息 (getep) 的功能。

    电影：视为单季单集的剧集。依赖搜索时获取的 数据字段(`data`)，获取对应的单集信息。

    剧集：依赖TMDb的API、以及搜索时获取的 数据字段(`data`)，从TMDb请求，通过媒体ID，获取剧集的分集信息列表。

  + 部分实现 获取详细信息 (detail) 、获取标签 (gettags) 的功能。

    依赖搜索时获取的 数据字段(`data`)。获取媒体的部分详细信息和标签。因测试功能时，KikoPlay会一边显示“正在从 TMDb 获取信息… ”、一边卡住，未能测试。

+ refactor：代码重构

  + 从 本地媒体文件的自动关联数据 (match) 中同样组织出类似的数据字段(`data`)。

    \* *此功能仍然仅基于Emby的媒体库本地元数据文件。*
  
  + 更改了资料库右键菜单选项，实现`打开TMDb页面`。

### 0.0

0.0.1.210829_build

+ fix：修复bug。
  + 读取.xml的部分标签文本的时候，处理、获取、转换字符或数字字段时，不再会得到nil或空字符串。

0.0.1.210712_build

+ feature：新特性。

  + 部分实现了本地媒体文件的自动关联数据功能 (match) ，基于本地Emby的匹配。

    基于依照Emby组织的媒体文件夹，完全依赖于Emby从TMDb在线刮削完成并存在本地的媒体元数据。

    通过读取Emby在媒体文件路径下的元数据文件(.nfo文件，.xml文本)，来匹配及关联媒体信息、分集信息。

0.0.0.210629_build

+ docs：
  + 新建文件夹  (\*￣▽￣\*)

(\^ω\^) ∠ 感谢你一直看到了这里~~
